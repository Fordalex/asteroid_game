{% extends 'base.html' %}
{% block header %}FDS Games{% endblock %}
{% block content %}
<!-- Game title container -->
<main id="card-container" class="px-2 px-lg-3 d-flex justify-content-center">
    <div class="row m-0 px-2 py-2 d-flex justify-content-center" id="titleContainer"></div>
</main>
{% endblock %}

{% block extra_js %}
<script>
    // The title model
    class GameTitle {
        constructor() {
            this.image = '';
            this.title = '';
            this.description = '';
            this.link = '';
            this.beta = false;

            this.players = 1;
            this.online = 'No';
            this.local = 'No';
            this.comingSoon = '';

            this.highScore = '';
            this.highScoreName = '';

            this.mobile = false;
            this.tablet = false;
            this.desktop = false;
            this.mobileIcon = '<img src="https://img.icons8.com/color/28/000000/android.png" />';
            this.tabletIcon = '<img src="https://img.icons8.com/color/28/000000/android-tablet.png" />';
            this.desktopIcon = '<img src="https://img.icons8.com/color/28/000000/monitor.png" />';
        }
        html(id) {
            var compatible = []
            if (this.desktop) {
                compatible.push(this.desktopIcon)
            }
            if (this.tablet) {
                compatible.push(this.tabletIcon)
            }
            if (this.mobile) {
                compatible.push(this.mobileIcon)
            }
            if (this.beta) {
                this.beta = '<p class="text-danger float-right">Beta Testing <img src="https://img.icons8.com/color/35/000000/test-partial-passed.png"/></p>';
            } else {
                this.beta = '';
            }
            return `
            <div class="mx-2 my-2">
                <div class="card p-0" style="width: 18rem;">
                    <img class="card-img-top" src='${this.image}'
                        alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">${this.title} ${this.beta}</h5>
                        <div class="collapse" id="more-${id}">
                            <p class="card-text">${this.description}</p>
                            <small class="d-block"><b>Players:</b> ${this.players}</small>
                            <small class="d-block"><b>Online Multiplayer:</b> ${this.online}</small>
                            <small class="d-block"><b>Local Multiplayer:</b> ${this.local}</small>
                            <small class="d-block"><b>Compatible:</b></small>
                            ${compatible.join('')}
                            <hr>
                        </div>
                        <div>
                            <small><b>Coming soon:</b> ${this.comingSoon}</small>
                        </div>
                        <hr>
                        <p class="m-0"><b>Highest Score:</b> ${this.highScore}</p>
                        <p class="m-0"><b>Player:</b> ${this.highScoreName}</p>
                        <hr>
                        <div class="d-flex justify-content-center">
                            <button href="#more-${id}" data-toggle="collapse" class="btn btn-dark container-fluid mr-2">About</button>
                            <a href="${this.link}" class="btn btn-info float-right container-fluid">Play</a>
                        </div>
                        
                    </div>
                </div>
            </div>
            `
        }
    }
    // Creating the titles available
    var highScores = {{ highScores |safe }};

    var ufo_defence = new GameTitle();
    ufo_defence.image = '{{ url_for("static", filename="img/titles/asteroid_gameplay.png") }}';
    ufo_defence.title = 'UFO Defence';
    ufo_defence.description = "A survival game where an endless count of UFO's will attack with increasing difficulty. Use your skills and power-ups to try and get to the top of the leaderboard!";
    ufo_defence.link = '/ufo_defence';
    ufo_defence.comingSoon = "Shooting UFO's!"
    ufo_defence.desktop = true;
    ufo_defence.highScore = highScores['ufo_defence']['score']
    ufo_defence.highScoreName = highScores['ufo_defence']['name']
    
    var mastermind = new GameTitle();
    mastermind.image = '{{ url_for("static", filename="img/titles/mastermind_gameplay.png") }}';
    mastermind.title = 'Mastermind';
    mastermind.description = 'Mastermind is a game that requires you to use logic, speculation and reasoning skills to determine the sequence of the coloured counters. Can you outsmart the computer?';
    mastermind.link = '/mastermind_instructions';
    mastermind.comingSoon = 'More themes!';
    mastermind.mobile = true;
    mastermind.tablet = true;
    mastermind.desktop = true;
    mastermind.highScore = highScores['mastermind']['score']
    mastermind.highScoreName = highScores['mastermind']['name']

    var pong = new GameTitle();
    pong.image = '{{ url_for("static", filename="img/titles/pong_gameplay.png") }}';
    pong.title = 'Pong';
    pong.description = 'The classic old pong game now online, play with your friends or join a random room.';
    pong.link = '/pong_lobby/1';
    pong.comingSoon = 'Play against AI!';
    pong.desktop = true;
    pong.players = 2;
    pong.online = 'Yes'
    pong.highScore = 'None Yet';
    pong.highScoreName = 'None Yet';
    pong.beta = true;

    var allTitles = [ufo_defence, mastermind, pong]

    // Adding the titles to the page
    for(let i = 0; allTitles.length; i++) {
        $('#titleContainer').append(allTitles[i].html(i))
    }
</script>
{% endblock %}